name: backend
type: Load Balanced Web Service

http:
  path: '/'
  healthcheck:
    path: '/health'
    interval: 30s
    timeout: 5s
    healthy_threshold: 2
    unhealthy_threshold: 3

image:
  build:
    context: ./backend
    dockerfile: ./backend/Dockerfile
  port: 8000

cpu: 256
memory: 512
count: 1

network:
  vpc:
    security_groups:
      - from_cfn: ${COPILOT_APPLICATION_NAME}-${COPILOT_ENVIRONMENT_NAME}-jalapenoclusterSecurityGroup

secrets:
  OPENAI_API_KEY: /copilot/${COPILOT_APPLICATION_NAME}/${COPILOT_ENVIRONMENT_NAME}/secrets/OPENAI_API_KEY
  USDA_API_KEY: /copilot/${COPILOT_APPLICATION_NAME}/${COPILOT_ENVIRONMENT_NAME}/secrets/USDA_API_KEY
  DB_SECRET:
    from_cfn: ${COPILOT_APPLICATION_NAME}-${COPILOT_ENVIRONMENT_NAME}-jalapenoclusterAuroraSecret
